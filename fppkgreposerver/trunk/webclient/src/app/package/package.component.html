<app-upload-package id="uploadPackageModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"></app-upload-package>
<app-tag-package id="tagPackageModal" [package]="currentPackage" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"></app-tag-package>

<div class="card" *ngIf="(currentPackage)">
  <div class="card-header">
    <h5 class="text-primary float-left">{{currentPackage.name}}</h5>
    <app-fpc-version-select-box class="float-right"></app-fpc-version-select-box>

  </div>
  <div class="card-body">
    <p class="mb-1 font-italic" *ngIf="currentPackage.packagestate!='published'"><span class="text-muted">State: </span>{{currentPackage.packagestate}}</p>

    <p *ngIf="currentPackage.category || mayEditPackage" class="mb-1"><span class="text-muted">Category</span>
      <app-editable-component appEditableOnEnter (update)="patchPackageCategory()">
        <ng-template appViewMode>{{currentPackage.category}}</ng-template>
        <ng-template appEditMode>
          <select [(ngModel)]="currentPackage.categoryid">
            <option *ngFor="let category of categoryList" value="{{category.categoryid}}">{{category.name}}</option>
          </select>
        </ng-template>
      </app-editable-component>
    </p>

    <p *ngIf="currentPackage.keywords" class="mb-1"><span class="text-muted">Keywords</span> {{currentPackage.keywords}}</p>
    <p *ngIf="currentPackage.support || mayEditPackage" class="mb-1"><span class="text-muted">Support</span>
      <app-editable-component appEditableOnEnter (update)="patchSupportCategory()">
        <ng-template appViewMode>{{currentPackage.support}}</ng-template>
        <ng-template appEditMode>
          <input [(ngModel)]="currentPackage.support" />
        </ng-template>
      </app-editable-component>
    </p>
    <app-package-version *ngIf="selectedVersion" [package]="currentPackage" [packageVersion]="selectedVersion"></app-package-version>

    <div *ngIf="(!selectedVersion)">
      <p *ngIf="(selectedFPCVersion)">This package is not available for FPC-version {{selectedFPCVersion.name}}.</p>
    </div>

    <p class="card-text"></p>
    <p class="card-text"></p>

    <ngb-accordion class="accordion" id="accordionExample">
      <ngb-panel title="More information about the package" [disabled]="true">
        <ng-template ngbPanelContent>
        </ng-template>
      </ngb-panel>
      <ngb-panel title="Package versions">
        <ng-template ngbPanelContent>
          <ul class="list-group">
            <button type="button" class="list-group-item list-group-item-action" [class.active]="version==selectedVersion" *ngFor="let version of packageVersionList" (click)="selectVersion(version)">{{version.version | version}}</button>
          </ul>
        </ng-template>
      </ngb-panel>
      <ngb-panel title="Package dependencies" [disabled]="true">
        <ng-template ngbPanelContent>
        </ng-template>
      </ngb-panel>
    </ngb-accordion>


    <p class="card-text"></p>
    <button *ngIf="mayEditPackage" class="btn btn-primary" (click)="showUploadSourceDialog()">Upload source</button>
    <button *ngIf="mayEditPackage" class="btn" (click)="showTagDialog(fpcversion)">Add tag</button>
    <button class="btn" *ngIf="isAdmin && (currentPackage.packagestate=='acceptance')" (click)="approvePackage()">Approve</button>
  </div>
</div>